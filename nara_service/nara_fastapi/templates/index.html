<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>조달청 입찰공고 조회</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <!-- 헤더 -->
        <header>
            <h1>🏢 조달청 입찰공고 조회</h1>
            <p class="subtitle">자연어로 입찰공고를 실시간 조회합니다</p>
        </header>

        <!-- 검색 영역 -->
        <div class="search-box">
            <div class="input-group">
                <input 
                    type="text" 
                    id="queryInput" 
                    placeholder='예: "25년 11월", "2025년 4월"'
                    autocomplete="off"
                >
                <button id="searchBtn" onclick="search()">
                    <span id="btnText">검색</span>
                    <span id="btnSpinner" class="spinner hidden"></span>
                </button>
            </div>
            
            <!-- 고급 옵션 -->
            <details class="advanced-options">
                <summary>고급 옵션</summary>
                <div class="options-content">
                    <label>
                        페이지 번호:
                        <input type="number" id="pageNo" value="1" min="1">
                    </label>
                    <label>
                        결과 수:
                        <select id="numOfRows">
                            <option value="10">10개</option>
                            <option value="20">20개</option>
                            <option value="50">50개</option>
                            <option value="100" selected>100개</option>
                        </select>
                    </label>
                </div>
            </details>
        </div>

        <!-- 예시 -->
        <div class="examples">
            <p class="examples-title">💡 예시:</p>
            <div class="example-chips">
                <button class="chip" onclick="setQuery('25년 11월')">25년 11월</button>
                <button class="chip" onclick="setQuery('25년 12월')">25년 12월</button>
                <button class="chip" onclick="setQuery('26년 1월')">26년 1월</button>
            </div>
        </div>

        <!-- 필터 영역 -->
        <div id="filterContainer" class="filter-container hidden">
            <div class="filter-header">
                <h3>🔍 필터</h3>
                <button class="filter-reset" onclick="resetFilters()">초기화</button>
            </div>

            <div class="filter-groups">
                <!-- 공고 상태 필터 -->
                <div class="filter-group">
                    <label class="filter-label">공고 상태</label>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" name="status" value="all" checked onchange="handleStatusFilter(this)">
                            <span>전체</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="status" value="일반공고" onchange="handleStatusFilter(this)">
                            <span>일반공고</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="status" value="재입찰공고" onchange="handleStatusFilter(this)">
                            <span>재입찰공고</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="status" value="취소공고" onchange="handleStatusFilter(this)">
                            <span>취소공고</span>
                        </label>
                    </div>
                </div>

                <!-- 업무 구분 필터 -->
                <div class="filter-group">
                    <label class="filter-label">업무 구분</label>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" name="business" value="all" checked onchange="handleBusinessFilter(this)">
                            <span>전체</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="business" value="물품" onchange="handleBusinessFilter(this)">
                            <span>물품</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="business" value="용역" onchange="handleBusinessFilter(this)">
                            <span>용역</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="business" value="공사" onchange="handleBusinessFilter(this)">
                            <span>공사</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="business" value="외자" onchange="handleBusinessFilter(this)">
                            <span>외자</span>
                        </label>
                    </div>
                </div>

                <!-- 계약 방법 필터 -->
                <div class="filter-group">
                    <label class="filter-label">계약 방법</label>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" name="contract" value="all" checked onchange="handleContractFilter(this)">
                            <span>전체</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="contract" value="일반경쟁" onchange="handleContractFilter(this)">
                            <span>일반경쟁</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="contract" value="제한경쟁" onchange="handleContractFilter(this)">
                            <span>제한경쟁</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="contract" value="수의계약" onchange="handleContractFilter(this)">
                            <span>수의계약</span>
                        </label>
                    </div>
                </div>

                <!-- 금액 범위 필터 -->
                <div class="filter-group">
                    <label class="filter-label">예산 규모</label>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" name="amount" value="all" checked onchange="handleAmountFilter(this)">
                            <span>전체</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="amount" value="0-10000000" onchange="handleAmountFilter(this)">
                            <span>1천만원 미만</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="amount" value="10000000-50000000" onchange="handleAmountFilter(this)">
                            <span>1천만원~5천만원</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="amount" value="50000000-100000000" onchange="handleAmountFilter(this)">
                            <span>5천만원~1억원</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="amount" value="100000000-999999999999" onchange="handleAmountFilter(this)">
                            <span>1억원 이상</span>
                        </label>
                    </div>
                </div>

                <!-- 검색어 필터 -->
                <div class="filter-group">
                    <label class="filter-label">공고명 검색</label>
                    <input 
                        type="text" 
                        id="searchKeyword" 
                        class="filter-search-input"
                        placeholder="공고명으로 검색..."
                        oninput="applyFilters()"
                    >
                </div>
            </div>
        </div>

        <!-- 검색 결과 헤더 -->
        <div id="resultHeader" class="result-header hidden">
            <div class="result-header-content">
                <div>
                    <h2>📋 검색 결과 
                        <span id="resultCount" class="count-badge"></span>
                        <span id="filteredCount" class="count-badge-secondary hidden"></span>
                    </h2>
                    <p id="searchPeriod" class="search-period"></p>
                </div>
                <div class="result-actions">
                    <select id="sortSelect" onchange="applySorting()">
                        <option value="default">기본 순서</option>
                        <option value="date-desc">공고일 최신순</option>
                        <option value="date-asc">공고일 오래된순</option>
                        <option value="amount-desc">예산 높은순</option>
                        <option value="amount-asc">예산 낮은순</option>
                        <option value="deadline-asc">마감일 임박순</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- 입찰공고 카드 목록 -->
        <div id="bidCards" class="bid-cards-container"></div>

        <!-- 로딩 인디케이터 -->
        <div id="loadingIndicator" class="loading-indicator hidden">
            <div class="loading-spinner"></div>
            <p>입찰공고를 조회하는 중...</p>
        </div>

        <!-- 에러 메시지 -->
        <div id="errorContainer" class="error-container hidden">
            <div class="error-content">
                <span class="error-icon">⚠️</span>
                <div>
                    <h3>오류 발생</h3>
                    <p id="errorMessage"></p>
                </div>
            </div>
        </div>

        <!-- 빈 결과 -->
        <div id="emptyResult" class="empty-result hidden">
            <div class="empty-icon">📭</div>
            <h3>검색 결과가 없습니다</h3>
            <p>다른 기간으로 검색하거나 필터를 조정해보세요</p>
        </div>

        <!-- 푸터 -->
        <footer>
            <p>
                💡 <a href="/docs" target="_blank">API 문서</a> | 
                <a href="/api/info" target="_blank">API 정보</a> |
                <a href="https://www.g2b.go.kr" target="_blank">나라장터</a>
            </p>
            <p class="footer-note">
                ⚠️ 실시간 공공데이터 연동 서비스
            </p>
        </footer>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>